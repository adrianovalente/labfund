; Coloque aqui seus imports
DUMPER 		<
DUMP_INI 	<
DUMP_TAM 	<
DUMP_UL 	<
DUMP_BL 	<
DUMP_EXE 	<
LOADER 		<
LOADER_UL	<
CHTOI		<
ENDWORD1	<
ENDWORD2	<
ISEXEC		<

		& 	/0000
MAIN	JP 	INI		; salta para o in�cio do programa
UL		K 	/0000 	; par�metro: UL onde est� o arquivo de batch

;INI		...			; coloque aqui o c�digo do seu monitor batch


INI		LD 		DISCO
		+		UL
		MM		DISCO
		SC		RGD
		-		BARRA
		JZ		CHECKJB
		LV		/0002
		JP		ERRO

CHECKJB	SC		RGD
		-		JOB_CTE
		JZ		LOOP
		LV      /0001
		JP		ERRO

LOOP	SC		RGD
		-		EOL_CTE
		JZ		LOOP
		+		EOL_CTE
		-		BARRA
		JZ		CMD
		+		BARRA
		-		END_CTE
		JZ		OKK
		LV		/0004
		JP		ERRO

CMD		SC		RGD
		-		LOAD_CTE
		JZ		LOAD_CALL
		+		LOAD_CTE
		-		DUMP_CTE
		JZ		DUMP_CALL
		+		DUMP_CTE
		-		EX_CTE
		JZ		EX_CALL
		+		EX_CTE
		-		CLEAR_CTE
		JZ		CLEAR_CALL
		LV		/0002
		JP		ERRO

LOAD_CALL	SC	LOAD_RUN
			-	TRES
			JZ	ERRO3
			+	TRES
			JP	LOOP

DUMP_CALL 	SC	DUMP_RUN
			-	TRES
			JZ	ERRO3
			+	TRES
			JP	LOOP

EX_CALL     SC  EX_RUN
			-	TRES
			JZ	ERRO3
			+   TRES
			-	CINCO
			JZ	ERRO5
			+	CINCO
			JP	LOOP

CLEAR_CALL	LV  CVAR1
			MM	VAR_ADDRESS
			SC	CLEAR_RUN
			-	TRES
			JZ	ERRO3
			+	TRES
			JP	LOOP

AUX			K	/0000
NUM_PARAM	K	/0000
VAR_ADDRESS	K	/0000
CLEAR_RUN	K	/0000
			SC	RGD
			-	EOL_CTE
			JZ	CLEAR_VAR
			LV  /0003
			RS  CLEAR_RUN
CLEAR_VAR	LV  /0000
			SC	RGD
			-	ESPACO
			JZ  CLEAR_VAR
			+	ESPACO
			-	EOL_CTE
			JZ  CLEAR_END
			+	EOL_CTE
			MM	CHTOI1
			LV  CHTOI1
			MM  ENDWORD1
			SC	RGD
			MM	CHTOI2
			LV  CHTOI2
			MM	ENDWORD2
			SC	CHTOI
			MM	AUX
			LD  MOVE_INS
			+   VAR_ADDRESS
			MM  CLEAR_MOVE
			LD  AUX
CLEAR_MOVE	K	/0000
			LD  NUM_PARAM
			+	UM
			MM	NUM_PARAM
			LD  VAR_ADDRESS
			-	DOIS
			MM	VAR_ADDRESS
			JP	CLEAR_VAR
CLEAR_END	LD 	NUM_PARAM
			*	CEM
			MM	NUM_PARAM
			LD  OS_INS
			+	NUM_PARAM
			+	C0
			MM	OS_RUN
			JP  OS_RUN
CVARF		K	/0000
CVARE		K	/0000
CVARD		K	/0000
CVARC		K	/0000
CVARB		K	/0000
CVARA		K	/0000
CVAR9		K	/0000
CVAR8		K	/0000
CVAR7		K	/0000
CVAR6		K	/0000
CVAR5		K	/0000
CVAR4		K	/0000
CVAR3		K	/0000
CVAR2		K	/0000
CVAR1		K	/0000
OS_RUN		K	/0000
			RS  CLEAR_RUN

OKK LV /0000
JP ERRO

EX_RUN		K	/0000
			LV  /0000
			MM  ISEXEC
			SC	LOAD_RUN
			OS	/0EF
			RS	EX_RUN
EX_ERROR	LV  /0005
			RS	EX_RUN

LOAD_RUN	K	/0000
			SC	RGD
			-	EOL_CTE
			JZ	LOAD_VAR
			LV	/0003
			RS	LOAD_RUN
LOAD_VAR	SC	RGD
			MM	CHTOI1
			LV  CHTOI1
			MM  ENDWORD1
			SC	RGD
			MM	CHTOI2
			LV  CHTOI2
			MM	ENDWORD2
			SC	CHTOI
			MM	LOADER_UL
			SC	RGD
			-	EOL_CTE
			JZ	LOADER_EXEC
			LV	/0003
			RS	LOAD_RUN
LOADER_EXEC	SC	LOADER
			RS	LOAD_RUN

DUMP_RUN	K	/0000
			SC	RGD
			-	EOL_CTE
			JZ	DUMP_VAR
			LV	/0003
			RS	DUMP_RUN
DUMP_VAR	SC	RGD
			MM	CHTOI1
			LV 	CHTOI1
			MM	ENDWORD1
			SC	RGD
			MM	CHTOI2
			LV 	CHTOI2
			MM	ENDWORD2
			SC	CHTOI
			MM	DUMP_BL
			SC	RGD
			-	ESPACO
			JZ	DUMP_VAR2
			LV	/0003
			RS	DUMP_RUN
DUMP_VAR2	SC	RGD
			MM	CHTOI1
			LV 	CHTOI1
			MM	ENDWORD1
			SC	RGD
			MM	CHTOI2
			LV 	CHTOI2
			MM	ENDWORD2
			SC	CHTOI
			MM	DUMP_INI
			SC	RGD
			-	ESPACO
			JZ	DUMP_VAR3
			LV	/0003
			RS	DUMP_RUN
DUMP_VAR3	SC	RGD
			MM	CHTOI1
			LV 	CHTOI1
			MM	ENDWORD1
			SC	RGD
			MM	CHTOI2
			LV 	CHTOI2
			MM	ENDWORD2
			SC	CHTOI
			MM	DUMP_TAM
			SC	RGD
			-	ESPACO
			JZ	DUMP_VAR4
			LV	/0003
			RS	DUMP_RUN
DUMP_VAR4	SC	RGD
			MM	CHTOI1
			LV 	CHTOI1
			MM	ENDWORD1
			SC	RGD
			MM	CHTOI2
			LV 	CHTOI2
			MM	ENDWORD2
			SC	CHTOI
			MM	DUMP_EXE
			SC	RGD
			-	ESPACO
			JZ	DUMP_VAR5
			LV	/0003
			RS	DUMP_RUN
DUMP_VAR5	SC	RGD
			MM	CHTOI1
			LV 	CHTOI1
			MM	ENDWORD1
			SC	RGD
			MM	CHTOI2
			LV 	CHTOI2
			MM	ENDWORD2
			SC	CHTOI
			MM	DUMP_UL
			SC	RGD
			-	EOL_CTE
			JZ	DUMP_EXEC
			LV	/0003
			RS	DUMP_RUN
DUMP_EXEC	SC	DUMPER
			RS	DUMP_RUN

ERRO3		+	TRES
			JP 	ERRO
ERRO5		+	CINCO
ERRO		OS	/0EE
			JP	FIM

RGD			K	/0000
			LD  DISCO
			+	UL
			MM	MOVE
MOVE		K	/0000
			RS	RGD



FIM 	HM	FIM		; fim do programa

# MAIN

BARRA		K	'//
JOB_CTE		K	'JB
LOAD_CTE	K	'LO
DUMP_CTE	K	'DU
CLEAR_CTE 	K	'CL
EX_CTE		K	'EX
DISCO		GD	/300
MOVE_INS	MM	/0000
OS_INS		OS  /000
EOL_CTE		K	/0D0A
END_CTE		K	'/*
UM			K	/0001
DOIS		K	/0002
C0			K	/00C0
TRES		K	/0003
CINCO		K	/0005
FFF		K	/0FFF
CEM			K	/0100
ESPACO		K	/2020
CHTOI1		K	/0000
CHTOI2		K	/0000
